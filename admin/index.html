<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin ‚Äì KAU Cafeteria</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/style.css">
    <style>
        .tab-bar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--border);
            padding-bottom: 0;
        }
        .tab-btn {
            background: none;
            border: none;
            padding: 0.75rem 1.4rem;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--muted);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
            border-radius: 6px 6px 0 0;
        }
        .tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(192,57,43,0.05);
        }
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .day-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-bottom: 1.5rem;
        }
        .day-tab {
            padding: 0.45rem 1rem;
            border: 1.5px solid var(--border);
            border-radius: 99px;
            background: white;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.88rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--muted);
        }
        .day-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .day-tab:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }

        .override-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.2rem 0.6rem;
            background: rgba(184,134,11,0.12);
            color: #7B5E00;
            border-radius: 99px;
            font-size: 0.78rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .template-note {
            background: rgba(26,122,110,0.07);
            border: 1px solid rgba(26,122,110,0.2);
            border-radius: 8px;
            padding: 0.8rem 1rem;
            font-size: 0.88rem;
            color: var(--teal);
            margin-bottom: 1.2rem;
        }

        .override-note {
            background: rgba(184,134,11,0.07);
            border: 1px solid rgba(184,134,11,0.25);
            border-radius: 8px;
            padding: 0.8rem 1rem;
            font-size: 0.88rem;
            color: #7B5E00;
            margin-bottom: 1.2rem;
        }

        .section-actions {
            display: flex;
            gap: 0.8rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn-outline {
            background: none;
            border: 1.5px solid var(--border);
            color: var(--text);
            padding: 0.5rem 1.2rem;
            border-radius: 8px;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-outline:hover { border-color: var(--primary); color: var(--primary); }
        .btn-outline.danger:hover { border-color: var(--danger); color: var(--danger); }
    </style>
</head>
<body>
<div class="bg-pattern"></div>
<div class="container">

    <header>
        <div class="logo-area">
            <div class="logo-icon">‚öôÔ∏è</div>
            <div>
                <h1>Admin Panel</h1>
                <span class="tagline">Menu Management</span>
            </div>
        </div>
        <div class="user-actions">
            <a href="../index.html" class="btn secondary">‚Üê Back to Home</a>
        </div>
    </header>

    <main>
        <div id="alert-container"></div>

        <!-- Tab bar -->
        <div class="tab-bar">
            <button class="tab-btn active" data-tab="daily">üìÖ Daily Menu</button>
            <button class="tab-btn" data-tab="weekly">üóìÔ∏è Weekly Template</button>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             TAB 1 ‚Äî DAILY MENU
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="tab-panel active" id="tab-daily">

            <div class="dashboard-section">
                <h2>üìÖ Set Menu for a Specific Day</h2>
                <p style="color:var(--muted);font-size:0.9rem;margin-bottom:1.2rem">
                    Override the weekly template for any specific date ‚Äî for example if a dish is unavailable that day.
                    If no override exists, the site will automatically show the weekly template for that day of the week.
                </p>
                <div style="display:flex;gap:1rem;align-items:flex-end;flex-wrap:wrap">
                    <div class="form-group" style="margin:0">
                        <label for="menu-date">Select Date</label>
                        <input type="date" id="menu-date" style="width:180px">
                    </div>
                    <button class="btn" id="load-menu-btn">Load / Edit</button>
                </div>
            </div>

            <div id="menu-editor" style="display:none">
                <div class="dashboard-section">
                    <div style="display:flex;align-items:center;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem">
                        <h2 style="margin:0" id="editor-title">Editing Menu</h2>
                        <span id="override-badge" class="override-badge" style="display:none">‚ö° Override active</span>
                    </div>

                    <div id="template-note" class="template-note" style="display:none">
                        ‚úÖ No override for this date ‚Äî the <strong>weekly template</strong> will be shown automatically.
                        Edit below to create a one-day override.
                    </div>

                    <div id="override-note" class="override-note" style="display:none">
                        ‚ö° This date has a <strong>custom override</strong> that replaces the weekly template.
                    </div>

                    <div class="admin-grid" id="meals-editor"></div>

                    <div class="section-actions">
                        <button class="btn" id="save-menu-btn">üíæ Save as Override for This Day</button>
                        <button class="btn-outline danger" id="clear-override-btn" style="display:none">üóë Remove Override (use template)</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             TAB 2 ‚Äî WEEKLY TEMPLATE
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="tab-panel" id="tab-weekly">

            <div class="dashboard-section">
                <h2>üóìÔ∏è Weekly Template</h2>
                <p style="color:var(--muted);font-size:0.9rem;margin-bottom:1.5rem">
                    Set the default menu for each day of the week. This is automatically shown every week
                    unless you create a specific override for a date.
                </p>

                <div class="day-tabs" id="day-tabs">
                    <button class="day-tab active" data-day="0">Sunday</button>
                    <button class="day-tab" data-day="1">Monday</button>
                    <button class="day-tab" data-day="2">Tuesday</button>
                    <button class="day-tab" data-day="3">Wednesday</button>
                    <button class="day-tab" data-day="4">Thursday</button>
                    <button class="day-tab" data-day="5">Friday</button>
                    <button class="day-tab" data-day="6">Saturday</button>
                </div>

                <p id="weekly-day-title" style="font-family:'Playfair Display',serif;font-size:1.1rem;margin-bottom:1rem;color:var(--dark)"></p>

                <div class="admin-grid" id="weekly-meals-editor"></div>

                <div class="section-actions">
                    <button class="btn" id="save-weekly-btn">üíæ Save Weekly Template</button>
                    <span style="color:var(--muted);font-size:0.85rem">Changes apply to all future weeks automatically</span>
                </div>
            </div>
        </div>

    </main>
    <footer><p>¬© 2025 KAU Cafeteria Admin</p></footer>
</div>

<script type="module">
import { MenuAPI } from '../JS/menu-api.js';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const meals = [
    { key: 'breakfast', label: 'Breakfast', icon: 'üåÖ' },
    { key: 'lunch',     label: 'Lunch',     icon: '‚òÄÔ∏è' },
    { key: 'dinner',    label: 'Dinner',    icon: 'üåô' }
];

const DAYS = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];

let dailyMenuData   = { breakfast: [], lunch: [], dinner: [] };
let currentDateKey  = '';
let hasOverride     = false;

let weeklyTemplate  = {};   // { 0: {breakfast:[],lunch:[],dinner:[]}, 1: {...}, ... }
let currentDay      = 0;    // 0=Sunday ... 6=Saturday
let weeklyMenuData  = { breakfast: [], lunch: [], dinner: [] };

// Set today's date as default
document.getElementById('menu-date').value = new Date().toISOString().split('T')[0];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  TABS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
        if (btn.dataset.tab === 'weekly') loadWeeklyTemplate();
    });
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DAILY ‚Äî Load
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.getElementById('load-menu-btn').addEventListener('click', async () => {
    currentDateKey = document.getElementById('menu-date').value;
    if (!currentDateKey) { showAlert('Please select a date', 'danger'); return; }

    showAlert('Loading‚Ä¶', 'warning');
    const existing = await MenuAPI.getForDate(currentDateKey);
    hasOverride = !!existing;

    if (existing) {
        dailyMenuData = existing;
    } else {
        // Load from weekly template for that day of week
        const dayOfWeek = new Date(currentDateKey + 'T12:00:00').getDay();
        const tmpl = await MenuAPI.getWeeklyTemplate();
        dailyMenuData = (tmpl && tmpl[dayOfWeek])
            ? JSON.parse(JSON.stringify(tmpl[dayOfWeek]))   // deep copy
            : { breakfast: [], lunch: [], dinner: [] };
    }

    // Update UI
    const dateLabel = new Date(currentDateKey + 'T12:00:00')
        .toLocaleDateString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
    document.getElementById('editor-title').textContent = dateLabel;
    document.getElementById('override-badge').style.display   = hasOverride ? 'inline-flex' : 'none';
    document.getElementById('template-note').style.display    = hasOverride ? 'none' : 'block';
    document.getElementById('override-note').style.display    = hasOverride ? 'block' : 'none';
    document.getElementById('clear-override-btn').style.display = hasOverride ? 'inline-block' : 'none';

    buildEditor('meals-editor', dailyMenuData, 'daily');
    document.getElementById('menu-editor').style.display = 'block';
    showAlert('‚úÖ Loaded! Edit below then save.', 'success');
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DAILY ‚Äî Save override
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.getElementById('save-menu-btn').addEventListener('click', async () => {
    showAlert('Saving‚Ä¶', 'warning');
    const ok = await MenuAPI.saveForDate(currentDateKey, dailyMenuData);
    if (ok) {
        hasOverride = true;
        document.getElementById('override-badge').style.display    = 'inline-flex';
        document.getElementById('template-note').style.display     = 'none';
        document.getElementById('override-note').style.display     = 'block';
        document.getElementById('clear-override-btn').style.display = 'inline-block';
        showAlert('‚úÖ Override saved! Students will see this menu on ' + currentDateKey, 'success');
    } else {
        showAlert('‚ùå Error saving. Try again.', 'danger');
    }
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DAILY ‚Äî Clear override
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.getElementById('clear-override-btn').addEventListener('click', async () => {
    showAlert('Removing override‚Ä¶', 'warning');
    const ok = await MenuAPI.clearOverride(currentDateKey);
    if (ok) {
        hasOverride = false;
        document.getElementById('override-badge').style.display    = 'none';
        document.getElementById('template-note').style.display     = 'block';
        document.getElementById('override-note').style.display     = 'none';
        document.getElementById('clear-override-btn').style.display = 'none';
        // Reload from template
        const dayOfWeek = new Date(currentDateKey + 'T12:00:00').getDay();
        const tmpl = await MenuAPI.getWeeklyTemplate();
        dailyMenuData = (tmpl && tmpl[dayOfWeek])
            ? JSON.parse(JSON.stringify(tmpl[dayOfWeek]))
            : { breakfast: [], lunch: [], dinner: [] };
        buildEditor('meals-editor', dailyMenuData, 'daily');
        showAlert('‚úÖ Override removed. Weekly template will be used.', 'success');
    } else {
        showAlert('‚ùå Error. Try again.', 'danger');
    }
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  WEEKLY ‚Äî Load template
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadWeeklyTemplate() {
    showAlert('Loading weekly template‚Ä¶', 'warning');
    const tmpl = await MenuAPI.getWeeklyTemplate();
    weeklyTemplate = tmpl || {};
    switchDay(currentDay);
    showAlert('', '');
}

function switchDay(day) {
    currentDay = day;
    weeklyMenuData = weeklyTemplate[day]
        ? JSON.parse(JSON.stringify(weeklyTemplate[day]))
        : { breakfast: [], lunch: [], dinner: [] };

    document.getElementById('weekly-day-title').textContent = `${DAYS[day]}'s Default Menu`;
    document.querySelectorAll('.day-tab').forEach(t => {
        t.classList.toggle('active', parseInt(t.dataset.day) === day);
    });
    buildEditor('weekly-meals-editor', weeklyMenuData, 'weekly');
}

document.querySelectorAll('.day-tab').forEach(btn => {
    btn.addEventListener('click', () => switchDay(parseInt(btn.dataset.day)));
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  WEEKLY ‚Äî Save template
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.getElementById('save-weekly-btn').addEventListener('click', async () => {
    weeklyTemplate[currentDay] = JSON.parse(JSON.stringify(weeklyMenuData));
    showAlert('Saving‚Ä¶', 'warning');
    const ok = await MenuAPI.saveWeeklyTemplate(weeklyTemplate);
    if (ok) {
        showAlert(`‚úÖ ${DAYS[currentDay]}'s template saved! It will show automatically every ${DAYS[currentDay]}.`, 'success');
    } else {
        showAlert('‚ùå Error saving. Try again.', 'danger');
    }
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  SHARED ‚Äî Build meal editor
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function buildEditor(containerId, dataObj, scope) {
    const container = document.getElementById(containerId);
    container.innerHTML = meals.map(meal => `
        <div class="admin-meal-form">
            <h3>${meal.icon} ${meal.label}</h3>
            <ul class="item-list" id="${scope}-list-${meal.key}"></ul>
            <div class="add-item-row">
                <input type="text" id="${scope}-input-${meal.key}" placeholder="Add a dish‚Ä¶">
                <button onclick="addItem('${scope}','${meal.key}')">+</button>
            </div>
        </div>
    `).join('');
    meals.forEach(m => renderList(containerId, dataObj, scope, m.key));
}

function renderList(containerId, dataObj, scope, mealKey) {
    const list  = document.getElementById(`${scope}-list-${mealKey}`);
    const items = dataObj[mealKey] || [];
    list.innerHTML = items.length === 0
        ? '<li style="color:var(--muted);font-size:0.9rem;padding:0.4rem 0">No items yet</li>'
        : items.map((item, i) => `
            <li>
                <span>${item}</span>
                <button class="remove-item" onclick="removeItem('${scope}','${mealKey}',${i})">‚úï</button>
            </li>
          `).join('');
}

window.addItem = function(scope, mealKey) {
    const input = document.getElementById(`${scope}-input-${mealKey}`);
    const val   = input.value.trim();
    if (!val) return;
    const dataObj = scope === 'daily' ? dailyMenuData : weeklyMenuData;
    if (!dataObj[mealKey]) dataObj[mealKey] = [];
    dataObj[mealKey].push(val);
    input.value = '';
    renderList(scope === 'daily' ? 'meals-editor' : 'weekly-meals-editor', dataObj, scope, mealKey);
};

window.removeItem = function(scope, mealKey, index) {
    const dataObj = scope === 'daily' ? dailyMenuData : weeklyMenuData;
    dataObj[mealKey].splice(index, 1);
    renderList(scope === 'daily' ? 'meals-editor' : 'weekly-meals-editor', dataObj, scope, mealKey);
};

document.addEventListener('keydown', e => {
    if (e.key === 'Enter' && e.target.id.includes('-input-')) {
        const parts = e.target.id.split('-input-');
        window.addItem(parts[0], parts[1]);
    }
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  ALERTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showAlert(msg, type) {
    const c = document.getElementById('alert-container');
    if (!msg) { c.innerHTML = ''; return; }
    const el = document.createElement('div');
    el.className = `alert alert-${type}`;
    el.textContent = msg;
    c.innerHTML = '';
    c.appendChild(el);
    if (type !== 'warning') setTimeout(() => el.remove(), 6000);
}

</script>
</body>
</html>
